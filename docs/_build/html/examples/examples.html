<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Examples &#8212; DEBrowser v1.30.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=00024e28"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h1>
<p>This guide is walkthrough for the preparation of figures which is used in DEBrowser paper. PCA, Heatmap, All2All will be plotted as an example for QC plots. Next, differential expression analysis will be conducted and their results will be visualized with Main plots such as <strong>Scatter</strong>, <strong>Volcano</strong> and <strong>MA</strong>. More detailed analysis will be covered by using simultaneously created Heatmap and KEGG pathway on the selected portion of the data.</p>
<section id="qc-plots-without-batch-effect-correction">
<h2>QC plots without Batch Effect Correction<a class="headerlink" href="#qc-plots-without-batch-effect-correction" title="Link to this heading">¶</a></h2>
<blockquote>
<div><ol class="arabic simple">
<li><p><strong>Upload Data:</strong> To begin the analysis, you need to load Demo Data by clicking <strong>Load Demo (Donnard et al)!</strong> button. Then click on <strong>Filter</strong> button to start <strong>Low Count Filtering</strong>.</p></li>
<li><p><strong>Low Count Filtering:</strong> Filtering method is selected as <strong>Max</strong> with cutoff 10 (which filter genes where maximum count for each gene across all samples are less than 10) and activated by clicking <strong>Filter</strong> button which is located at the center of the page. After filtration you can see the distribution of the data as shown at below. Now, you can proceed by clicking <strong>Batch Effect Correction</strong> button.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/example_filtering.png"><img alt="../_images/example_filtering.png" class="align-center" src="../_images/example_filtering.png" style="width: 99%;" />
</a>
<ol class="arabic" start="3">
<li><p><strong>Batch Effect Correction and Normalization:</strong>  Following options were selected to normalize the data:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Normalization method:</strong> MRN</p></li>
<li><p><strong>Correction Method:</strong> None</p></li>
</ul>
</div></blockquote>
</li>
</ol>
<p>In order to adjust the appearance, use PCA controls which is located between two PCA plots.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Text On/Off:</strong> On</p></li>
<li><p><strong>Select legend:</strong> color</p></li>
<li><p><strong>Color field:</strong> batch</p></li>
<li><p><strong>Shape field:</strong> batch</p></li>
</ul>
</div></blockquote>
<a class="reference internal image-reference" href="../_images/example_pca_before_batch.png"><img alt="../_images/example_pca_before_batch.png" class="align-center" src="../_images/example_pca_before_batch.png" style="width: 60%;" />
</a>
<ol class="arabic simple" start="4">
<li><p><strong>All2All:</strong>  After batch effect correction, you can click ‘Go to QC plots!’ to view quality control metrics on your data. The page opens with a Principal Component Analysis (PCA) plot. You can select <strong>All2All</strong> option from <strong>Plot type</strong> on the left sidebar menu. In order to get the figure as shown at below, you need to adjust other parameters of <strong>plot options</strong>    on the left sidebar menu.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/example_all2all_before.png"><img alt="../_images/example_all2all_before.png" class="align-center" src="../_images/example_all2all_before.png" style="width: 55%;" />
</a>
<ul>
<li><p><strong>All2All - Plot Options:</strong> Following options are selected and their screenshots are shown at below.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Plot Type:</strong> All2All</p></li>
<li><p><strong>Data Options:</strong> Choose a dataset: all-detected</p></li>
<li><p><strong>QC options - all2all - Size &amp; Margins:</strong> Check the box of the <strong>Plot Size</strong> and adjust width and height as 800 and 800, respectively.</p></li>
<li><p><strong>QC options - all2all - Options:</strong>  corr font size: 1.8 (adjust the font size of the text inside the box)</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<a class="reference internal image-reference" href="../_images/example_all2all_menu.png"><img alt="../_images/example_all2all_menu.png" class="align-center" src="../_images/example_all2all_menu.png" style="width: 40%;" />
</a>
<ol class="arabic simple" start="5">
<li><p><strong>Heatmap:</strong>  To visualize heatmap as shown at below, please select <strong>Heatmap</strong> option from <strong>Plot type</strong> on the left sidebar menu and adjust plot options.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/example_heatmap_before.png"><img alt="../_images/example_heatmap_before.png" class="align-center" src="../_images/example_heatmap_before.png" style="width: 40%;" />
</a>
<ul>
<li><p><strong>Heatmap - Plot Options:</strong> Similar to All2All plot, we need to adjust plotting options on the left sidebar menu.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Plot Type:</strong> Heatmap</p></li>
<li><p><strong>Heatmap Colors:</strong> Check the box of custom colors.</p></li>
<li><p><strong>Data Options:</strong> Choose a dataset: most varied, top-n:1000, total min count:100 (to show the top 1000 most varied genes (based on coefficient of variance) whose total counts are higher than 100)</p></li>
<li><p><strong>QC options - kmeans:</strong> Check the box of kmeans clustering. Select 7 as # of clusters. You might need to change the order of the clusters and click <strong>change order</strong> button to get gradual changes on heatmap as in the figure.</p></li>
<li><p><strong>QC options - heatmap - Size &amp; Margins:</strong> Check the box of the <strong>Plot Size</strong> and adjust width and height to 690 and 1200, respectively.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<img alt="../_images/example_heatmap_menu.png" class="align-center" src="../_images/example_heatmap_menu.png" />
</div></blockquote>
</section>
<section id="qc-plots-after-batch-effect-correction">
<h2>QC plots after Batch Effect Correction<a class="headerlink" href="#qc-plots-after-batch-effect-correction" title="Link to this heading">¶</a></h2>
<p>Since we finalized out plots without applying batch effect correction, we can return back to batch effect correction step and change the <strong>Correction Method</strong> as <strong>Combat</strong> and continue to create new graphs with the same parameters as we used before. To make it more user friendly, we are going to start explain these steps from the beginning. If you choose to continue from batch effect correction, please skip first two steps and continue reading from 3rd step: <strong>Batch Effect Correction and Normalization</strong>.</p>
<blockquote>
<div><ol class="arabic">
<li><p><strong>Upload Data:</strong> To begin the analysis, load Demo Data by clicking <strong>Load Demo (Donnard et al)!</strong> button. Then click on <strong>Filter</strong> button to start <strong>Low Count Filtering</strong>.</p></li>
<li><p><strong>Low Count Filtering:</strong> Select <strong>Max</strong> method with cutoff 10 (which filter genes where maximum count for each gene across all samples are less than 10), then click <strong>Filter</strong> button which is located at the center of the page. After filtration, proceed to next step by clicking <strong>Batch Effect Correction</strong> button.</p></li>
<li><p><strong>Batch Effect Correction and Normalization:</strong>  Following options were selected to apply both normalization and batch effect correction:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Normalization method:</strong> MRN</p></li>
<li><p><strong>Correction Method:</strong> Combat</p></li>
<li><p><strong>Treatment:</strong> treatment</p></li>
<li><p><strong>Batch:</strong> batch</p></li>
</ul>
</div></blockquote>
</li>
</ol>
<p>Please adjust PCA controls (which is located between two PCA plots) as listed below.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Text On/Off:</strong> On</p></li>
<li><p><strong>Select legend:</strong> color</p></li>
<li><p><strong>Color field:</strong> batch</p></li>
<li><p><strong>Shape field:</strong> batch</p></li>
</ul>
</div></blockquote>
<a class="reference internal image-reference" href="../_images/example_pca_after_batch.png"><img alt="../_images/example_pca_after_batch.png" class="align-center" src="../_images/example_pca_after_batch.png" style="width: 60%;" />
</a>
<ol class="arabic simple" start="4">
<li><p><strong>All2All:</strong>  After batch effect correction, click ‘Go to QC plots!’ and select <strong>All2All</strong> option from <strong>Plot type</strong> on the left sidebar menu. Please adjust All2All - Plot Options as listed below.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/example_all2all_after.png"><img alt="../_images/example_all2all_after.png" class="align-center" src="../_images/example_all2all_after.png" style="width: 55%;" />
</a>
<ul>
<li><p><strong>All2All - Plot Options:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Plot Type:</strong> All2All</p></li>
<li><p><strong>Data Options:</strong> Choose a dataset: all-detected</p></li>
<li><p><strong>QC options - all2all - Size &amp; Margins:</strong> Check the box of the <strong>Plot Size</strong> and adjust width and height to 800 and 800, respectively.</p></li>
<li><p><strong>QC options - all2all - Options:</strong>  corr font size: 1.8</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<a class="reference internal image-reference" href="../_images/example_all2all_menu.png"><img alt="../_images/example_all2all_menu.png" class="align-center" src="../_images/example_all2all_menu.png" style="width: 40%;" />
</a>
<ol class="arabic simple" start="5">
<li><p><strong>Heatmap:</strong>  Please select <strong>Heatmap</strong> option from <strong>Plot type</strong> on the left sidebar menu and adjust plot options according to the list below.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/example_heatmap_after.png"><img alt="../_images/example_heatmap_after.png" class="align-center" src="../_images/example_heatmap_after.png" style="width: 40%;" />
</a>
<ul>
<li><p><strong>Heatmap - Plot Options:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Plot Type:</strong> Heatmap</p></li>
<li><p><strong>Heatmap Colors:</strong> Check the box of custom colors.</p></li>
<li><p><strong>Data Options:</strong> Choose a dataset: most varied, top-n:1000, total min count:100 (to show the top 1000 most varied genes (based on coefficient of variance) whose total counts are higher than 100)</p></li>
<li><p><strong>QC options - kmeans:</strong> Check the box of kmeans clustering. Select 7 as # of clusters. You might need to change the order of the clusters and click <strong>change order</strong> button to get gradual changes on heatmap as in the figure.</p></li>
<li><p><strong>QC options - heatmap - Size &amp; Margins:</strong> Check the box of the <strong>Plot Size</strong> and adjust width and height to 690 and 1200, respectively.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<img alt="../_images/example_heatmap_menu.png" class="align-center" src="../_images/example_heatmap_menu.png" />
</div></blockquote>
</section>
<section id="the-differential-expression-plots">
<h2>The Differential Expression Plots<a class="headerlink" href="#the-differential-expression-plots" title="Link to this heading">¶</a></h2>
<blockquote>
<div><ol class="arabic">
<li><p><strong>Upload Data:</strong> To begin the analysis, load Count Data by clicking <strong>Load Demo (Vernia et. al)!</strong> button. Then click on <strong>Filter</strong> button to start <strong>Low Count Filtering</strong>.</p></li>
<li><p><strong>Low Count Filtering:</strong> Select <strong>Max</strong> method with cutoff 10 (which filter genes where maximum count for each gene across all samples are less than 10), then click <strong>Filter</strong> button which is located at the center of the page. Proceed to next step by clicking <strong>Batch Effect Correction</strong> button.</p></li>
<li><p><strong>Batch Effect Correction and Normalization:</strong>  We are going to skip both normalization and batch effect correction by selecting following options:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Normalization method:</strong> None</p></li>
<li><p><strong>Correction Method:</strong> None</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>DE Analysis:</strong>  After batch effect correction, click ‘Go to DE Analysis’. In this page, we will add groups for comparison. Click on <strong>Add New Comparison</strong> button and select <strong>Select Meta</strong> as <strong>treatment</strong>. It will automatically separate experiment and control data into two groups. You can leave other parameters as default as listed below and click “Submit” button.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>DE method:</strong> DESeq2</p></li>
<li><p><strong>Fit Type:</strong> parametric</p></li>
<li><p><strong>betaPrior:</strong> FALSE</p></li>
<li><p><strong>Test Type:</strong> Wald</p></li>
</ul>
</div></blockquote>
</li>
</ol>
<a class="reference internal image-reference" href="../_images/example_DE_form.png"><img alt="../_images/example_DE_form.png" class="align-center" src="../_images/example_DE_form.png" style="width: 90%;" />
</a>
<ol class="arabic simple" start="5">
<li><p><strong>Main Plots Analysis:</strong> Upon finishing the DESeq analysis, you will see DE Results in table format. Please click on <strong>Go to Main Plots!</strong> button which will open <strong>Scatter Plot</strong>. You can switch to <strong>Volcano Plot</strong> and <strong>MA Plot</strong> by using <strong>Plot Type</strong> section at the left side of the menu. Since these plots are interactive, you can click to <strong>zoom</strong> button on the top of the graph and select the area you would like to zoom in by drawing a rectangle. Please see the plots at below:</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/example_main_plots.png"><img alt="../_images/example_main_plots.png" class="align-center" src="../_images/example_main_plots.png" style="width: 99%;" />
</a>
<p>Please keep in mind that to increace the performance of the generating graph, by default 10% of non-significant(NS) genes are used to generate plots. We used all of the NS genes in our plots that showed above, therefore please click <strong>Main Options</strong> button and change Background Data(%) to 100% on the left sidebar.</p>
<a class="reference internal image-reference" href="../_images/example_background_data.png"><img alt="../_images/example_background_data.png" class="align-center" src="../_images/example_background_data.png" style="width: 30%;" />
</a>
<ol class="arabic simple" start="6">
<li><p><strong>Read count plots:</strong> Lets return back to <strong>Scatter Plot</strong> by using <strong>Plot Type</strong> section. You can hover on each point on the graph to see their read counts as a bar graph as shown at below. In this example FABP3 is selected to show the high variance of this gene across samples.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/example_scatter_hover.png"><img alt="../_images/example_scatter_hover.png" class="align-center" src="../_images/example_scatter_hover.png" style="width: 99%;" />
</a>
<p>If you want to mark FABP3 gene on the plot, click on Data Options and enter <strong>FABP3</strong> in to the <strong>search field</strong> as showed below. You will see green mark on the plot that shows FABP3.</p>
<a class="reference internal image-reference" href="../_images/example_scatter_search.png"><img alt="../_images/example_scatter_search.png" class="align-center" src="../_images/example_scatter_search.png" style="width: 30%;" />
</a>
<ol class="arabic simple" start="7">
<li><p><strong>Lasso selection:</strong> DEBrowser can draw heatmaps of any selected region of any main plot. Selection can be made in a rectangular form or as a free-form using plotly’s lasso select. To do so, first click <strong>NS</strong> label at the upper right side of the figure, and hide non-significant genes. Then click on lasso select button at the top of the plot and select the genes you’re interested as shown at below. Heatmap will appear just next to scatter plot. Additionally, you can activate interactive mapping option for heatmap by clicking <strong>Interactive</strong> button under <strong>Heatmap Options</strong> on the left sidebar menu. Now, you can hover on the each block of heatmap to see gene name and its value.</p></li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Interactive Feature:</strong> In order to increase the performance of the generating heatmaps, <strong>interactive</strong> option is disabled by default. After deciding plotting/clustering parameters of the heatmap, you might activate this feature to investigate each block in detail.</p>
</div>
<a class="reference internal image-reference" href="../_images/example_scatter_lasso.png"><img alt="../_images/example_scatter_lasso.png" class="align-center" src="../_images/example_scatter_lasso.png" style="width: 60%;" />
</a>
<a class="reference internal image-reference" href="../_images/example_scatter_lasso_heatmap.png"><img alt="../_images/example_scatter_lasso_heatmap.png" class="align-center" src="../_images/example_scatter_lasso_heatmap.png" style="width: 99%;" />
</a>
<ol class="arabic" start="8">
<li><p><strong>Scatter plot of the genes enriched in insulin signalling pathway:</strong> In this example, we will highlight genes enriched in insulin signalling pathway. If you already hid NS genes, you can show them by clicking on the <strong>NS</strong> label at the upper right side of the figure. Click on the <strong>Data Options</strong> and enter following genes in to the <strong>search field</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Cbl</span>
<span class="n">Sos1</span>
<span class="n">Irs2</span>
<span class="n">Insr</span>
<span class="n">Ptprf</span>
<span class="n">Tsc1</span>
<span class="n">Crkl</span>
<span class="n">Prkar2a</span>
<span class="n">Acaca</span>
<span class="n">Fasn</span>
<span class="n">Mapk8</span>
<span class="n">Ppp1r3b</span>
<span class="n">Ppp1r3c</span>
<span class="n">Srebf1</span>
<span class="n">Pklr</span>
<span class="n">Pik3r1</span>
<span class="n">Pygl</span>
<span class="n">Pik3r3</span>
<span class="n">Socs4</span>
<span class="n">Socs2</span>
<span class="n">Eif4ebp1</span>
</pre></div>
</div>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you enter more than three lines of genes, search tool will automatically match the beginning and end of the search phrases. Otherwise it will find matched substrings in the gene list.</p>
</div>
<p>Now, you will see green marks on the <strong>searched genes</strong> as shown below:</p>
<a class="reference internal image-reference" href="../_images/example_scatter_insulin_A.png"><img alt="../_images/example_scatter_insulin_A.png" class="align-center" src="../_images/example_scatter_insulin_A.png" style="width: 60%;" />
</a>
<p>Lets, hide all the genes other then <strong>searched genes</strong> by clicking <strong>NS</strong>, <strong>Up</strong> and <strong>Down</strong> labels at the upper right side of the figure. Since only the selected genes are left on the graph, we can select these genes by clicking on <strong>Select Box</strong> icon and drawing a rectangle which covers all of these genes.</p>
<a class="reference internal image-reference" href="../_images/example_scatter_insulin_select.png"><img alt="../_images/example_scatter_insulin_select.png" class="align-center" src="../_images/example_scatter_insulin_select.png" style="width: 60%;" />
</a>
<p>Here as shown below, heatmap will be simultaneously created just next to scatter plot. You might need to change plot margins as following:</p>
<ul class="simple">
<li><p><strong>Heatmap options -&gt; heatmap - Size &amp; Margins:</strong> Please check the box of the <strong>Plot Size</strong> and adjust width and height to 580 and 500, respectively.</p></li>
</ul>
<blockquote>
<div><a class="reference internal image-reference" href="../_images/example_scatter_insulin_before_norm.png"><img alt="../_images/example_scatter_insulin_before_norm.png" class="align-center" src="../_images/example_scatter_insulin_before_norm.png" style="width: 60%;" />
</a>
</div></blockquote>
<p>Since the data is not normalized, data of exper_rep3 looks like it belongs to control group. We strongly recommend normalization before plotting subset of genes. To normalize, please change the parameters as described below and see the updated figure at below:</p>
<ul class="simple">
<li><p><strong>Data options -&gt; Normalization Methods:</strong> Please select <strong>MRN</strong> from the dropdown box.</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/example_scatter_insulin_B.png"><img alt="../_images/example_scatter_insulin_B.png" class="align-center" src="../_images/example_scatter_insulin_B.png" style="width: 60%;" />
</a>
</div></blockquote>
<p>Activating <strong>Interactive</strong> feature changes the heatmap into an interactive version with two colors, allowing you to select specific genes to be compared
within the GO term plots.</p>
</section>
<section id="go-term-plots">
<h2>GO Term Plots<a class="headerlink" href="#go-term-plots" title="Link to this heading">¶</a></h2>
<p>The next tab, ‘GO Term’, takes you to the ontology comparison portion of DEBrowser.  From here you can select the standard dataset options such as p-adjust value, fold change cut off value, which comparison set to use, and which dataset to use on the left menu.  In addition to these parameters, you also can choose from the 4 different ontology plot options: ‘enrichGO’,’enrichKEGG’, ‘Disease’, and ‘compareCluster’.  Selecting one of these plot options queries their specific databases with your current DESeq results.</p>
<img alt="../_images/go_plots_opts.png" class="align-center" src="../_images/go_plots_opts.png" />
<p>Your GO plots include:</p>
<ul class="simple">
<li><p>enrichGO - use enriched GO terms</p></li>
<li><p>enrichKEGG - use enriched KEGG terms</p></li>
<li><p>Disease - enriched for diseases</p></li>
<li><p>compareClusters - comparison of your clustered data</p></li>
</ul>
<p>The types of plots you will be able to generate include:</p>
<p>Summary plot:</p>
<img alt="../_images/go_summary.png" class="align-center" src="../_images/go_summary.png" />
<p>GOdotplot:</p>
<img alt="../_images/go_dot_plot.png" class="align-center" src="../_images/go_dot_plot.png" />
<p>Changing the type of ontology to use will also produce custom parameters for that specific ontology at the bottom of the
left option panel.</p>
<p>Once you have adjusted all of your parameters, you may hit the submit button in the top right and then wait
for the results to show on screen!</p>
</section>
<section id="log2-fold-change-comparison-for-ppar-pathway">
<h2>Log2 fold change comparison for PPARα pathway<a class="headerlink" href="#log2-fold-change-comparison-for-ppar-pathway" title="Link to this heading">¶</a></h2>
<blockquote>
<div><ol class="arabic simple">
<li><p><strong>Upload Data:</strong> To begin the analysis, download <a class="reference external" href="https://bioinfo.umassmed.edu/pub/debrowser/advanced_demo.tsv">full dataset (Vernia et. al)</a> and <a class="reference external" href="https://bioinfo.umassmed.edu/pub/debrowser/advanced_meta.tsv">full metadata</a> on your computer. Then click <strong>browse</strong> button, and select downloaded files from your computer. Please keep <strong>Separator</strong> as <strong>Tab</strong> while this processes. Finally click <strong>upload</strong> button to see <strong>Upload Summary</strong>. Now you can click on <strong>Filter</strong> button to start <strong>Low Count Filtering</strong>.</p></li>
</ol>
<ol class="arabic" start="2">
<li><p><strong>Low Count Filtering:</strong> Select <strong>Max</strong> method with cutoff 10 (which filter genes where maximum count for each gene across all samples are less than 10), then click <strong>Filter</strong> button which is located at the center of the page. We are going to skip normalization and batch effect correction step by clicking ‘Go to DE Analysis’ button.</p></li>
<li><p><strong>DE Analysis:</strong>  In this page, we will add multiple groups for comparison. Click on <strong>Add New Comparison</strong> button and select <strong>Select Meta</strong> as <strong>Cond1</strong>. Repeat this step for <strong>Cond2</strong> and <strong>Cond3</strong> and add two more comparisons. It will automatically separate experiment and control data into two groups. You can leave other parameters as default as listed below and click “Submit” button.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>DE method:</strong> DESeq2</p></li>
<li><p><strong>Fit Type:</strong> parametric</p></li>
<li><p><strong>betaPrior:</strong> FALSE</p></li>
<li><p><strong>Test Type:</strong> Wald</p></li>
</ul>
</div></blockquote>
</li>
</ol>
<a class="reference internal image-reference" href="../_images/example_multi_cond.png"><img alt="../_images/example_multi_cond.png" class="align-center" src="../_images/example_multi_cond.png" style="width: 70%;" />
</a>
<ol class="arabic" start="4">
<li><p><strong>Downloading fold2Change data of selected genes</strong>: Upon finishing the DE analysis, you will see DE Results in table format. Please click on <strong>Go to Main Plots!</strong> button which will open <strong>Scatter Plot</strong>. On the left sidebar menu, click <a href="#id1"><span class="problematic" id="id2">**</span></a>Data options* tab and enter following genes regarding to PPARα pathway:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Cyp4a12b</span>
<span class="n">Cyp4a14</span>
<span class="n">Ehhadh</span>
<span class="n">Cyp8b1</span>
<span class="n">Cpt1b</span>
<span class="n">Cyp7b1</span>
<span class="n">Slc27a1</span>
<span class="n">Apoa5</span>
<span class="n">Pdpk1</span>
<span class="n">Apoa1</span>
<span class="n">Acadl</span>
<span class="n">Fads2</span>
<span class="n">Fabp4</span>
<span class="n">Acadm</span>
<span class="n">Apoa2</span>
<span class="n">Apoc3</span>
<span class="n">Fgf21</span>
<span class="n">Fabp5</span>
<span class="n">Fabp3</span>
<span class="n">Lpl</span>
<span class="n">Dbi</span>
<span class="n">Nr1h3</span>
<span class="n">Fabp7</span>
<span class="n">Ppara</span>
<span class="n">Ucp1</span>
<span class="n">Sdc1</span>
<span class="n">Sdc3</span>
<span class="n">Sdc2</span>
<span class="n">Fabp2</span>
</pre></div>
</div>
</li>
</ol>
<p>Afterwards, select <strong>comparison</strong> option for the <strong>Choose a dataset</strong> field. This option will add fold change columns to to our data.</p>
<p>Now, we need to disable filtration to get all searched genes in our dataset. To do so, enter following parameters into <strong>Filter</strong> field on the left sidebar menu.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>padj:</strong> 1</p></li>
<li><p><strong>foldChange:</strong> 1</p></li>
</ul>
</div></blockquote>
<p>To confirm you can check all adjusted parameters at image below.</p>
<a class="reference internal image-reference" href="../_images/example_fold_selection.png"><img alt="../_images/example_fold_selection.png" class="align-center" src="../_images/example_fold_selection.png" style="width: 30%;" />
</a>
<p>It is time to download our dataset by clicking <strong>Download Data</strong> button on the <strong>Data Options</strong> field. You can open downloaded tsv file in Excel or similar programs. Once you open the file, you will see columns of count data, padj and fold2Change for all comparisons. Since we are only interested in fold2Change columns, you can delete the rest. Final data file should look like image on the left at below.</p>
<p>We will rename column names as follows and add new column called <strong>chow.wt</strong> which compares chow.wildtype with itself therefore it is filled with 1.</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>foldChange.C1.vs.C2</strong> to chow.dbl</p></li>
<li><p><strong>foldChange.C3.vs.C4</strong> to hfd.wt</p></li>
<li><p><strong>foldChange.C5.vs.C6</strong> to hfd.dbl</p></li>
</ul>
</div></blockquote>
<p>To confirm you can also download the final version of the fold2data from <a class="reference external" href="https://bioinfo.umassmed.edu/pub/debrowser/comparisons.tsv">this link</a>.</p>
<a class="reference internal image-reference" href="../_images/example_table_conversion.png"><img alt="../_images/example_table_conversion.png" class="align-center" src="../_images/example_table_conversion.png" style="width: 70%;" />
</a>
<ol class="arabic" start="5">
<li><p><strong>Creating Heatmap for fold2change data</strong>: To create heatmap for fold change data, you have two options: A. Using startHeatmap() function or B. Use DEBrowser Heatmap module.</p>
<blockquote>
<div><ul>
<li><ol class="upperalpha">
<li><p>Open new R session and run following command in R or R Studio to run Heatmap module in web browser:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">startHeatmap</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
</li>
</ul>
<p>Similar to DEBrowser, you can click <strong>browse</strong> button, and select prepared log2change file from your computer. Please keep <strong>Separator</strong> as <strong>Tab</strong>. Finally click <strong>upload</strong> button to see <strong>Upload Summary</strong>.</p>
<ul>
<li><ol class="upperalpha" start="2">
<li><p>Open new R session and run following command in R or R Studio to load dataset as data frame (comparisons):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">comparisons</span> <span class="o">&lt;-</span> <span class="n">read</span><span class="o">.</span><span class="n">delim</span><span class="p">(</span><span class="s2">&quot;~/Downloads/comparisons.tsv&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">names</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>You may need to change the path of the file according to your folder structure. Now, in order to open heatmap module, you need to run following script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>library(debrowser)
library(DESeq2)
library(heatmaply)
library(RColorBrewer)
library(gplots)

options(warn=-1)
header &lt;- dashboardHeader(title = &quot;DEBrowser Heatmap&quot;)
sidebar &lt;- dashboardSidebar(  getJSLine(), sidebarMenu(id=&quot;DataAssessment&quot;,
    menuItem(&quot;Heatmap&quot;, tabName = &quot;Heatmap&quot;),
    plotSizeMarginsUI(&quot;heatmap&quot;),
    heatmapControlsUI(&quot;heatmap&quot;)))
body &lt;- dashboardBody(
    tabItems(
    tabItem(tabName=&quot;Heatmap&quot;,  getHeatmapUI(&quot;heatmap&quot;),
        column(4, verbatimTextOutput(&quot;heatmap_hover&quot;), verbatimTextOutput(&quot;heatmap_selected&quot;)
        )
    )
))

ui &lt;- dashboardPage(header, sidebar, body, skin = &quot;blue&quot;)

server &lt;- function(input, output, session) {
selected &lt;- reactiveVal()
observe({
    withProgress(message = &#39;Creating plot&#39;, style = &quot;notification&quot;, value = 0.1, {
    selected(callModule(debrowserheatmap, &quot;heatmap&quot;, comparisons))
    })
})
output$heatmap_hover &lt;- renderPrint({
    if (!is.null(selected()) &amp;&amp; !is.null(selected()$shgClicked()) &amp;&amp; selected()$shgClicked() != &quot;&quot;)
        return(paste0(&quot;Clicked: &quot;,selected()$shgClicked()))
    else
        return(paste0(&quot;Hovered:&quot;, selected()$shg()))
})
output$heatmap_selected &lt;- renderPrint({
    if (!is.null(selected()))
        selected()$selGenes()
})
}

shinyApp(ui, server)
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
</ol>
<p>Shiny will launch a web browser which is ready to use as a heatmap module. You need to specify following parameters to create log2fold change graph:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Interactive:</strong> Checked</p></li>
<li><p><strong>Custom Colors:</strong> Checked</p></li>
<li><p><strong>Custom Colors -&gt; Choose min colour:</strong> #33FF00</p></li>
<li><p><strong>Custom Colors -&gt; Choose median colour:</strong> #000000</p></li>
<li><p><strong>Custom Colors -&gt; Choose max colour:</strong> #FF0000</p></li>
<li><p><strong>Heatmap Dendrogram -&gt; Type:</strong> none</p></li>
<li><p><strong>Scale Options -&gt; Scale:</strong> Checked</p></li>
<li><p><strong>Scale Options -&gt; Center:</strong> Unchecked</p></li>
<li><p><strong>Scale Options -&gt; Log:</strong> Checked</p></li>
<li><p><strong>Scale Options -&gt; Pseudo Count:</strong> 0</p></li>
</ul>
</div></blockquote>
<p>Once you specify these parameters, your heatmap will be seen as image at below.</p>
<a class="reference internal image-reference" href="../_images/example_log_heatmap.png"><img alt="../_images/example_log_heatmap.png" class="align-center" src="../_images/example_log_heatmap.png" style="width: 70%;" />
</a>
</div></blockquote>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">DEBrowser</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Alper Kucukural, Manuel Garber, Onur Yukselen.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/examples/examples.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>